(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1441:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n(125),r=n(372),i=n(1),s=n(9),l=n.n(s),c=n(2),u=n(3),b=n(69),f=n(68),m=n(247);function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,o,r,i,s=[],l=!0,c=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=r.call(n)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return g(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}e.default=function(t){var e=t.match.params,n=e.tab,s=void 0===n?"general":n,g=e.subTab,w=void 0===g?"":g;Object(o.a)("general",!1,""),Object(u.l)(Object(i.__)("Settings","wp-marketing-automations"));var v=Object(a.useContext)(u.h),h=Object(a.useContext)(m.a).setHasUnsavedChanges,_=bwfanParams,O=_.bwfan_global_settings_schema,j=void 0===O?{}:O,p=_.bwfan_global_settings,y=void 0===p?{}:p,S=d(Object(a.useState)(j),2),E=S[0],A=S[1],k=d(Object(a.useState)(y),2),x=k[0],C=k[1],T=d(Object(a.useState)({}),2),P=T[0],I=T[1],q=[];E.forEach((function(t){Array.isArray(t.tabs)&&t.tabs.forEach((function(t){Object(c.isNull)(t)||Array.isArray(t.fields)&&t.fields.forEach((function(t){t.required&&q.push({id:t.id,label:t.label})}))}))}));var D=function t(e,n,a){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(r,s){var c=y.bwfan_sandbox_mode,b=void 0!==c&&c,f=e.bwfan_sandbox_mode,m=void 0!==f&&f;if(m!==b&&!o)return n(!1),void I({title:m?Object(i.__)("Enable Sandbox Mode?","wp-marketing-automations"):Object(i.__)("Disable Sandbox mode?","wp-marketing-automations"),content:m?Object(i.__)("You are about to enable sandbox mode. All active automation and ongoing broadcasts will be halted.","wp-marketing-automations"):Object(i.__)("You are about to disable sandbox mode. All active automation and ongoing broadcasts will start running again.","wp-marketing-automations"),status:!0,onConfirm:function(){n(!0),I({}),t(e,n,a,!0).then((function(){r()}))},onCancel:function(){n(!1),s()}});try{l()({path:Object(u.y)("/settings"),method:"POST",data:{bwfan_global_settings:e}}).then((function(t){if(200===t.code){v(t.message);var e=t.result;e&&(window.bwfanParams.bwfan_global_settings=a,window.bwfanParams.bwfan_global_settings_schema=e.schema,C(e.values),A(e.schema),h(!1))}else v(t.message);r()})).catch((function(t){console.log(t),v(t.message),s()})).finally((function(){n(!1),Object(u.Eb)(v,3e3)}))}catch(t){console.log(t),v(t.message),Object(u.Eb)(v,3e3),n(!1)}}))},Y=function(t){var e={};return q.forEach((function(n){Object(c.isEmpty)(t[n.id])&&(e[n.id]=n.label+Object(i.__)(" field is required !","wp-marketing-automations"))})),e};return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(f.a,null),E.map((function(t){return Object(a.createElement)(r.a,{key:"setting-tab--"+t.key,fields:t.tabs,values:x,onSubmit:D,validate:Y,setSettingFieldSchema:A,activeTab:s,activeSubTab:w})})),Object(a.createElement)(b.a,{modalTitle:P.title,deleteDescriptionText:P.content,confirmButtonText:Object(i.__)("Yes, I confirm","wp-marketing-automations"),onConfirm:P.onConfirm,onCancel:P.onCancel,isLoading:!1,onRequestClose:function(){return I({status:!1})},isOpen:P.status,isDelete:!0}))}}}]);